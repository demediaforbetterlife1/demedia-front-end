"use client";

import React, { createContext, useContext, useEffect, useMemo, useState } from "react";

type Translations = Record<string, string>;

type Locale = string;

interface I18nContextType {
  language: Locale;
  setLanguage: (lng: Locale) => void;
  t: (key: string, fallback?: string) => string;
  supportedLocales: { code: string; name: string }[];
}

const I18nContext = createContext<I18nContextType | undefined>(undefined);

export const useI18n = (): I18nContextType => {
  const ctx = useContext(I18nContext);
  if (!ctx) throw new Error("useI18n must be used within I18nProvider");
  return ctx;
};

// 100+ ISO codes mapped to human names. Many will alias to English until translations are provided.
const SUPPORTED: { code: string; name: string }[] = [
  { code: "en", name: "English" },
  { code: "ar", name: "Arabic" },
  { code: "es", name: "Spanish" },
  { code: "fr", name: "French" },
  { code: "de", name: "German" },
  { code: "tr", name: "Turkish" },
  { code: "it", name: "Italian" },
  { code: "ru", name: "Russian" },
  { code: "zh", name: "Chinese (Simplified)" },
  { code: "zh-TW", name: "Chinese (Traditional)" },
  { code: "ja", name: "Japanese" },
  { code: "ko", name: "Korean" },
  { code: "pt", name: "Portuguese" },
  { code: "pt-BR", name: "Portuguese (Brazil)" },
  { code: "hi", name: "Hindi" },
  { code: "bn", name: "Bengali" },
  { code: "pa", name: "Punjabi" },
  { code: "ur", name: "Urdu" },
  { code: "fa", name: "Persian" },
  { code: "id", name: "Indonesian" },
  { code: "ms", name: "Malay" },
  { code: "vi", name: "Vietnamese" },
  { code: "th", name: "Thai" },
  { code: "ta", name: "Tamil" },
  { code: "te", name: "Telugu" },
  { code: "mr", name: "Marathi" },
  { code: "gu", name: "Gujarati" },
  { code: "kn", name: "Kannada" },
  { code: "ml", name: "Malayalam" },
  { code: "or", name: "Odia" },
  { code: "as", name: "Assamese" },
  { code: "ne", name: "Nepali" },
  { code: "si", name: "Sinhala" },
  { code: "my", name: "Burmese" },
  { code: "km", name: "Khmer" },
  { code: "lo", name: "Lao" },
  { code: "am", name: "Amharic" },
  { code: "sw", name: "Swahili" },
  { code: "ha", name: "Hausa" },
  { code: "yo", name: "Yoruba" },
  { code: "ig", name: "Igbo" },
  { code: "zu", name: "Zulu" },
  { code: "xh", name: "Xhosa" },
  { code: "af", name: "Afrikaans" },
  { code: "nl", name: "Dutch" },
  { code: "sv", name: "Swedish" },
  { code: "no", name: "Norwegian" },
  { code: "da", name: "Danish" },
  { code: "fi", name: "Finnish" },
  { code: "pl", name: "Polish" },
  { code: "cs", name: "Czech" },
  { code: "sk", name: "Slovak" },
  { code: "hu", name: "Hungarian" },
  { code: "ro", name: "Romanian" },
  { code: "bg", name: "Bulgarian" },
  { code: "uk", name: "Ukrainian" },
  { code: "el", name: "Greek" },
  { code: "he", name: "Hebrew" },
  { code: "sr", name: "Serbian" },
  { code: "hr", name: "Croatian" },
  { code: "sl", name: "Slovenian" },
  { code: "bs", name: "Bosnian" },
  { code: "mk", name: "Macedonian" },
  { code: "et", name: "Estonian" },
  { code: "lv", name: "Latvian" },
  { code: "lt", name: "Lithuanian" },
  { code: "is", name: "Icelandic" },
  { code: "ga", name: "Irish" },
  { code: "mt", name: "Maltese" },
  { code: "cy", name: "Welsh" },
  { code: "sq", name: "Albanian" },
  { code: "az", name: "Azerbaijani" },
  { code: "kk", name: "Kazakh" },
  { code: "ky", name: "Kyrgyz" },
  { code: "uz", name: "Uzbek" },
  { code: "tk", name: "Turkmen" },
  { code: "mn", name: "Mongolian" },
  { code: "ps", name: "Pashto" },
  { code: "ku", name: "Kurdish" },
  { code: "bo", name: "Tibetan" },
  { code: "dv", name: "Divehi" },
  { code: "hy", name: "Armenian" },
  { code: "ka", name: "Georgian" },
  { code: "be", name: "Belarusian" },
  { code: "tt", name: "Tatar" },
  { code: "ba", name: "Bashkir" },
  { code: "kkj", name: "Kako" },
  { code: "qu", name: "Quechua" },
  { code: "ay", name: "Aymara" },
  { code: "gn", name: "Guarani" },
  { code: "ht", name: "Haitian Creole" },
  { code: "lb", name: "Luxembourgish" },
  { code: "rm", name: "Romansh" },
  { code: "eo", name: "Esperanto" },
  { code: "la", name: "Latin" },
  { code: "tl", name: "Tagalog" },
  { code: "fil", name: "Filipino" },
  { code: "sr-Latn", name: "Serbian (Latin)" },
  { code: "kk-Cyrl", name: "Kazakh (Cyrillic)" },
  { code: "kk-Latn", name: "Kazakh (Latin)" },
  { code: "bs-Latn", name: "Bosnian (Latin)" },
  { code: "bs-Cyrl", name: "Bosnian (Cyrillic)" },
];

const BASE_TRANSLATIONS: Record<Locale, Translations> = {
  en: {
    "auth.welcomeBack": "Welcome Back",
    "auth.login": "Login",
    "auth.signUp": "Sign Up",
    "auth.email": "Email Address",
    "auth.phone": "Phone Number",
    "auth.password": "Password",
    "auth.noAccount": "Don't have an account?",
    "auth.haveAccount": "Already have an account?",
    "auth.signingIn": "Signing In...",
    "auth.creatingAccount": "Creating Account...",
    "setup.completeProfile": "Complete Your Profile",
    "setup.preferredLanguage": "Preferred Language",
    "setup.phoneNumber": "Phone Number",
    "setup.saveContinue": "Save & Continue",
    "setup.saving": "Saving...",
    "common.save": "Save",
    "common.continue": "Continue",
    "common.loading": "Loading",
    "navbar.notifications": "Notifications",
    "navbar.messages": "Messages",
    "navbar.profile": "Profile",
    "navbar.logout": "Logout",
    "settings.title": "Settings",
    "settings.language": "Language",
    "settings.account": "Account",
    "settings.security": "Security",
    "settings.notifications": "Notifications",
    "settings.privacy": "Privacy",
    "settings.appearance": "Appearance",
    "settings.support": "Support",
    "index.checkingAuth": "Checking authentication...",
    "posts.loading": "Loading posts...",
    "posts.none": "No posts yet.",
    "posts.error": "Error",
    "posts.unknown": "Unknown",
    "posts.image": "Image",
    "posts.like": "Like",
    "posts.comment": "Comment",
    "posts.share": "Share",
    "stories.add": "Add Story",
    "stories.loading": "Loading stories...",
    "stories.none": "No stories yet.",
    "stories.error": "Error loading stories",
    "home.welcome": "Welcome to DeMedia",
    "home.feed": "Your Feed",
    "home.trending": "Trending",
    "home.suggestions": "Suggestions",
    "auth.name": "Full Name",
    "auth.username": "Username",
    "auth.confirmPassword": "Confirm Password",
    "auth.rememberMe": "Remember me",
    "auth.forgotPassword": "Forgot password?",
    "auth.verificationSent": "Verification email sent to your Gmail! Please check your inbox and click the verification link to complete login.",
    "auth.checkGmail": "ğŸ“§ Check your Gmail inbox for the verification link",
    "auth.resendVerification": "Resend verification email",
    "auth.usernameRequired": "Username is required",
    "auth.usernameMinLength": "Username must be at least 3 characters",
    "auth.nameRequired": "Full name is required",
    "auth.emailRequired": "Email address is required",
    "auth.passwordRequired": "Password is required",
    "auth.passwordMinLength": "Password must be at least 8 characters",
    "auth.passwordMatch": "Passwords must match",
    "auth.usernameTaken": "This username is already taken",
    "auth.emailRegistered": "This email address is already registered",
    "auth.registrationFailed": "Registration failed. Please try a different username or email address.",
    "auth.registrationFailedGeneric": "Registration failed. Please try again.",
    "auth.loginFailed": "Login failed",
    "auth.invalidCredentials": "Invalid credentials",
    "auth.userCreated": "User created successfully. You can now login.",
    "auth.creatingAccount": "Creating Account...",
    "auth.signingIn": "Signing In...",
    "auth.login": "Login",
    "auth.signUp": "Sign Up",
    "auth.signUpTitle": "Create Account",
    "auth.welcomeBack": "Welcome Back",
    "auth.welcomeTitle": "Join DeMedia",
    "auth.alreadyHaveAccount": "Already have an account?",
    "auth.dontHaveAccount": "Don't have an account?",
    "auth.goToLogin": "Go to Login",
    "auth.tryAgain": "Try Again",
    "auth.emailInvalid": "Please enter a valid email address",
    "auth.usernameInvalid": "Username can only contain lowercase letters, numbers, and underscores",
  },
  ar: {
    "auth.welcomeBack": "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ø¹ÙˆØ¯ØªÙƒ",
    "auth.login": "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
    "auth.signUp": "Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨",
    "auth.email": "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
    "auth.phone": "Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ",
    "auth.password": "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",
    "auth.noAccount": "Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ",
    "auth.haveAccount": "Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ",
    "auth.signingIn": "Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...",
    "auth.creatingAccount": "Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨...",
    "setup.completeProfile": "Ø£ÙƒÙ…Ù„ Ù…Ù„ÙÙƒ Ø§Ù„Ø´Ø®ØµÙŠ",
    "setup.preferredLanguage": "Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…ÙØ¶Ù„Ø©",
    "setup.phoneNumber": "Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ",
    "setup.saveContinue": "Ø­ÙØ¸ ÙˆÙ…ØªØ§Ø¨Ø¹Ø©",
    "setup.saving": "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...",
    "common.save": "Ø­ÙØ¸",
    "common.continue": "Ù…ØªØ§Ø¨Ø¹Ø©",
    "common.loading": "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„",
    "navbar.notifications": "Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª",
    "navbar.messages": "Ø§Ù„Ø±Ø³Ø§Ø¦Ù„",
    "navbar.profile": "Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ",
    "navbar.logout": "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬",
    "settings.title": "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",
    "settings.language": "Ø§Ù„Ù„ØºØ©",
    "settings.account": "Ø§Ù„Ø­Ø³Ø§Ø¨",
    "settings.security": "Ø§Ù„Ø£Ù…Ø§Ù†",
    "settings.notifications": "Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª",
    "settings.privacy": "Ø§Ù„Ø®ØµÙˆØµÙŠØ©",
    "settings.appearance": "Ø§Ù„Ù…Ø¸Ù‡Ø±",
    "settings.support": "Ø§Ù„Ø¯Ø¹Ù…",
    "index.checkingAuth": "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©...",
    "posts.loading": "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª...",
    "posts.none": "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø¨Ø¹Ø¯.",
    "posts.error": "Ø®Ø·Ø£",
    "posts.unknown": "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
    "posts.image": "ØµÙˆØ±Ø©",
    "posts.like": "Ø¥Ø¹Ø¬Ø§Ø¨",
    "posts.comment": "ØªØ¹Ù„ÙŠÙ‚",
    "posts.share": "Ù…Ø´Ø§Ø±ÙƒØ©",
    "stories.add": "Ø¥Ø¶Ø§ÙØ© Ù‚ØµØ©",
    "stories.loading": "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ØµØµ...",
    "stories.none": "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚ØµØµ Ø¨Ø¹Ø¯.",
    "stories.error": "Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ØµØµ",
    "home.welcome": "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¯ÙŠ Ù…ÙŠØ¯ÙŠØ§",
    "home.feed": "Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ",
    "home.trending": "Ø§Ù„Ø±Ø§Ø¦Ø¬",
    "home.suggestions": "Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª",
    "auth.name": "Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„",
    "auth.username": "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…",
    "auth.confirmPassword": "ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",
    "auth.rememberMe": "ØªØ°ÙƒØ±Ù†ÙŠ",
    "auth.forgotPassword": "Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ",
    "auth.verificationSent": "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ù„Ù‰ Ø¬ÙŠÙ…ÙŠÙ„ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ! ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ÙˆØ§Ø±Ø¯ ÙˆØ§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù‚Ù‚ Ù„Ø¥ÙƒÙ…Ø§Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.",
    "auth.checkGmail": "ğŸ“§ ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ†Ø¯ÙˆÙ‚ Ø¬ÙŠÙ…ÙŠÙ„ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù‚Ù‚",
    "auth.resendVerification": "Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù‚Ù‚",
    "auth.usernameRequired": "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø·Ù„ÙˆØ¨",
    "auth.usernameMinLength": "ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… 3 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„",
    "auth.nameRequired": "Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ø·Ù„ÙˆØ¨",
    "auth.emailRequired": "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø·Ù„ÙˆØ¨",
    "auth.passwordRequired": "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù…Ø·Ù„ÙˆØ¨Ø©",
    "auth.passwordMinLength": "ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± 8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„",
    "auth.passwordMatch": "ÙŠØ¬Ø¨ Ø£Ù† ØªØªØ·Ø§Ø¨Ù‚ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±",
    "auth.usernameTaken": "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„",
    "auth.emailRegistered": "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù‡Ø°Ø§ Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„",
    "auth.registrationFailed": "ÙØ´Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø®ØªÙ„Ù.",
    "auth.registrationFailedGeneric": "ÙØ´Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",
    "auth.loginFailed": "ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
    "auth.invalidCredentials": "Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ø¹ØªÙ…Ø§Ø¯ ØºÙŠØ± ØµØ­ÙŠØ­Ø©",
    "auth.userCreated": "ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.",
    "auth.creatingAccount": "Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨...",
    "auth.signingIn": "Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...",
    "auth.login": "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
    "auth.signUp": "Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨",
    "auth.signUpTitle": "Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨",
    "auth.welcomeBack": "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ø¹ÙˆØ¯ØªÙƒ",
    "auth.welcomeTitle": "Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ DeMedia",
    "auth.alreadyHaveAccount": "Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ",
    "auth.dontHaveAccount": "Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ",
    "auth.goToLogin": "Ø§Ù„Ø°Ù‡Ø§Ø¨ Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
    "auth.tryAgain": "Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
    "auth.emailInvalid": "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù†ÙˆØ§Ù† Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØµØ­ÙŠØ­",
    "auth.usernameInvalid": "ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø­Ø±Ù Ø§Ù„ØµØºÙŠØ±Ø© ÙˆØ§Ù„Ø£Ø±Ù‚Ø§Ù… ÙˆØ§Ù„Ø´Ø±Ø·Ø§Øª Ø§Ù„Ø³ÙÙ„ÙŠØ© ÙÙ‚Ø·",
  },
  es: {
    "auth.welcomeBack": "Bienvenido de nuevo",
    "auth.login": "Iniciar sesiÃ³n",
    "auth.signUp": "Registrarse",
    "auth.email": "Correo electrÃ³nico",
    "auth.password": "ContraseÃ±a",
    "auth.noAccount": "Â¿No tienes cuenta?",
    "auth.haveAccount": "Â¿Ya tienes cuenta?",
    "auth.signingIn": "Iniciando sesiÃ³n...",
    "auth.creatingAccount": "Creando cuenta...",
    "setup.completeProfile": "Completa tu perfil",
    "setup.preferredLanguage": "Idioma preferido",
    "setup.phoneNumber": "NÃºmero de telÃ©fono",
    "setup.saveContinue": "Guardar y continuar",
    "setup.saving": "Guardando...",
    "common.save": "Guardar",
    "common.continue": "Continuar",
    "common.loading": "Cargando",
    "navbar.notifications": "Notificaciones",
    "navbar.messages": "Mensajes",
    "navbar.profile": "Perfil",
    "navbar.logout": "Cerrar sesiÃ³n",
    "settings.title": "ConfiguraciÃ³n",
    "settings.language": "Idioma",
    "settings.account": "Cuenta",
    "settings.security": "Seguridad",
    "settings.notifications": "Notificaciones",
    "settings.privacy": "Privacidad",
    "settings.appearance": "Apariencia",
    "settings.support": "Soporte",
    "index.checkingAuth": "Verificando autenticaciÃ³n...",
    "posts.loading": "Cargando publicaciones...",
    "posts.none": "AÃºn no hay publicaciones.",
    "posts.error": "Error",
    "posts.unknown": "Desconocido",
    "posts.image": "Imagen",
    "posts.like": "Me gusta",
    "posts.comment": "Comentar",
    "posts.share": "Compartir",
    "stories.add": "Agregar historia",
    "stories.loading": "Cargando historias...",
    "stories.none": "AÃºn no hay historias.",
    "stories.error": "Error al cargar historias",
    "home.welcome": "Bienvenido a DeMedia",
    "home.feed": "Tu feed",
    "home.trending": "Tendencia",
    "home.suggestions": "Sugerencias",
  },
  fr: {
    "auth.welcomeBack": "Bon retour",
    "auth.login": "Connexion",
    "auth.signUp": "S'inscrire",
    "auth.email": "Adresse e-mail",
    "auth.password": "Mot de passe",
    "auth.noAccount": "Vous n'avez pas de compte ?",
    "auth.haveAccount": "Vous avez dÃ©jÃ  un compte ?",
    "auth.signingIn": "Connexion en cours...",
    "auth.creatingAccount": "CrÃ©ation du compte...",
    "setup.completeProfile": "ComplÃ©tez votre profil",
    "setup.preferredLanguage": "Langue prÃ©fÃ©rÃ©e",
    "setup.phoneNumber": "NumÃ©ro de tÃ©lÃ©phone",
    "setup.saveContinue": "Enregistrer et continuer",
    "setup.saving": "Enregistrement...",
    "common.save": "Enregistrer",
    "common.continue": "Continuer",
    "common.loading": "Chargement",
    "navbar.notifications": "Notifications",
    "navbar.messages": "Messages",
    "navbar.profile": "Profil",
    "navbar.logout": "DÃ©connexion",
    "settings.title": "ParamÃ¨tres",
    "settings.language": "Langue",
    "settings.account": "Compte",
    "settings.security": "SÃ©curitÃ©",
    "settings.notifications": "Notifications",
    "settings.privacy": "ConfidentialitÃ©",
    "settings.appearance": "Apparence",
    "settings.support": "Support",
    "index.checkingAuth": "VÃ©rification de l'authentification...",
    "posts.loading": "Chargement des publications...",
    "posts.none": "Aucune publication pour le moment.",
    "posts.error": "Erreur",
    "posts.unknown": "Inconnu",
    "posts.image": "Image",
    "posts.like": "J'aime",
    "posts.comment": "Commenter",
    "posts.share": "Partager",
    "stories.add": "Ajouter une histoire",
    "stories.loading": "Chargement des histoires...",
    "stories.none": "Aucune histoire pour le moment.",
    "stories.error": "Erreur lors du chargement des histoires",
    "home.welcome": "Bienvenue sur DeMedia",
    "home.feed": "Votre fil",
    "home.trending": "Tendances",
    "home.suggestions": "Suggestions",
  },
  de: {
    "auth.welcomeBack": "Willkommen zurÃ¼ck",
    "auth.login": "Anmelden",
    "auth.signUp": "Registrieren",
    "auth.email": "E-Mail-Adresse",
    "auth.password": "Passwort",
    "auth.noAccount": "Haben Sie kein Konto?",
    "auth.haveAccount": "Haben Sie bereits ein Konto?",
    "auth.signingIn": "Anmeldung lÃ¤uft...",
    "auth.creatingAccount": "Konto wird erstellt...",
    "setup.completeProfile": "VervollstÃ¤ndigen Sie Ihr Profil",
    "setup.preferredLanguage": "Bevorzugte Sprache",
    "setup.phoneNumber": "Telefonnummer",
    "setup.saveContinue": "Speichern und fortfahren",
    "setup.saving": "Speichern...",
    "common.save": "Speichern",
    "common.continue": "Fortfahren",
    "common.loading": "Laden",
    "navbar.notifications": "Benachrichtigungen",
    "navbar.messages": "Nachrichten",
    "navbar.profile": "Profil",
    "navbar.logout": "Abmelden",
    "settings.title": "Einstellungen",
    "settings.language": "Sprache",
    "settings.account": "Konto",
    "settings.security": "Sicherheit",
    "settings.notifications": "Benachrichtigungen",
    "settings.privacy": "Datenschutz",
    "settings.appearance": "Erscheinungsbild",
    "settings.support": "Support",
    "index.checkingAuth": "Authentifizierung wird Ã¼berprÃ¼ft...",
    "posts.loading": "BeitrÃ¤ge werden geladen...",
    "posts.none": "Noch keine BeitrÃ¤ge.",
    "posts.error": "Fehler",
    "posts.unknown": "Unbekannt",
    "posts.image": "Bild",
    "posts.like": "GefÃ¤llt mir",
    "posts.comment": "Kommentieren",
    "posts.share": "Teilen",
    "stories.add": "Geschichte hinzufÃ¼gen",
    "stories.loading": "Geschichten werden geladen...",
    "stories.none": "Noch keine Geschichten.",
    "stories.error": "Fehler beim Laden der Geschichten",
    "home.welcome": "Willkommen bei DeMedia",
    "home.feed": "Ihr Feed",
    "home.trending": "Trending",
    "home.suggestions": "VorschlÃ¤ge",
  },
};

export const I18nProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [language, setLanguageState] = useState<Locale>("en");
  const [translations, setTranslations] = useState<Record<Locale, Translations>>(BASE_TRANSLATIONS);

  useEffect(() => {
    const stored = typeof window !== "undefined" ? localStorage.getItem("language") : null;
    if (stored && SUPPORTED.find(l => l.code === stored)) {
      setLanguageState(stored);
    }
  }, []);

  const setLanguage = (lng: Locale) => {
    setLanguageState(lng);
    if (typeof window !== "undefined") localStorage.setItem("language", lng);
  };

  const t = (key: string, fallback?: string): string => {
    const lang = translations[language] || {};
    if (lang[key]) return lang[key];
    const en = translations["en"] || {};
    return en[key] || fallback || key;
  };

  const value = useMemo<I18nContextType>(() => ({
    language,
    setLanguage,
    t,
    supportedLocales: SUPPORTED,
  }), [language, translations]);

  return (
    <I18nContext.Provider value={value}>{children}</I18nContext.Provider>
  );
};


